convert base script into python. increase error handling
